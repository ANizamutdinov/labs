
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/xenial64" 
  
  config.vm.define :master do |master|
      master.vm.hostname = "salt"
      master.vm.synced_folder "salt/base", "/srv/salt"
      master.vm.network :forwarded_port,
              guest: "80",
              host: "8080"
      master.vm.network :forwarded_port,
              guest: "22",
              host: "1234"
      master.vm.network :private_network,
              ip: "172.16.10.10" ,
              netmask: "27",
              virtualbox__intnet: "salt-lab"
      master.vm.provision :salt do |salt|
          salt.install_master = true
          salt.minion_id = "master"
      end
  end
  
  (1..2).each do |i|
    config.vm.define "slave-#{i}" do |slave|
        slave.vm.hostname = "slave-#{i}"
        slave.vm.network :private_network,
                ip: "172.16.10.1#{i}" ,
                netmask: "27",
                virtualbox__intnet: "salt-lab"
      slave.vm.provision :salt do |salt|
          salt.install_master = false
          salt.minion_config = "salt/minion"
      end
    end
  end
end
